# 빌드 및 배포 가이드

## **1. 사용한 JVM, 웹서버, WAS 제품 등의 종류와 설정 값, 버전 (IDE 버전 포함)**

### **공통 / 인프라 (Common / Infra)**

| 구분 | 제품/버전 | 설정값/비고 |
| --- | --- | --- |
| **OS** | Ubuntu 22.04.04 LTS (Kernel 6.8.0-1033-aws) | Timezone: Etc/UTC, Locale: C.UTF-8 |
| **컨테이너** | Docker 28.3.2, Docker Compose 2.38.2 |  |
| **웹서버** | NGINX 1.25.5 | Alpine 기반, 리버스 프록시, HTTP/2·HTTP/3 지원, TLS 1.2/1.3(OpenSSL 3.1.4), 정적 파일 서빙 |
| **데이터베이스** | MySQL 9.4.0 Redis 8.0.3 | MySQL(영구 데이터), Redis(캐시) |
| **메시징 시스템** | Apache Kafka (Confluent Platform 7.3.2) | 비동기 이벤트 처리, 실시간 데이터 파이프라인 |
| **분산 코디네이터** | Apache Zookeeper (Confluent Platform 7.3.2) | 카프카 클러스터 메타데이터 관리 및 컨트롤러 선출 |
| **CI/CD** | Jenkins 2.516.1 | main/develop 브랜치 push 시 자동 배포 |


### **백엔드 (Backend)**

| 구분 | 제품/버전 | 설정값/비고 |
| --- | --- | --- |
| **JVM** | OpenJDK 17.0.16 | GC: G1GC, -Xms2g -Xmx2g, -XX:+UseContainerSupport |
| **WAS** | Apache Tomcat 10.1.25 | Spring Boot 3.3.1 내장 |
| **프레임워크** | Spring Boot 3.3.1 | Spring MVC, Security, Data JPA(Hibernate 6.5.2.Final), WebSocket |
| **빌드 도구** | Gradle 8.14.3 | JDK Toolchain: 17 |
| **IDE** | IntelliJ IDEA 2023.3.8 |  |


### **프론트엔드 (Frontend)**

| 구분 | 제품/버전 | 설정값/비고 |
| --- | --- | --- |
| **런타임** | Node.js 22 | Dockerfile node:22-alpine 사용(빌드 전용) |
| **패키지 매니저** | pnpm | pnpm-lock.yaml 기반 패키지 버전 관리 |
| **빌드 도구** | Vite 7.0.4 | @vitejs/plugin-react 4.6.0, vite.config.ts 사용 |
| **프레임워크** | React 19.1.0 | React Router DOM 7.7.1 |
| **상태/데이터** | Zustand 5.0.6, TanStack Query 5.83.0 | @tanstack/react-query, Devtools 5.83.0 |
| **실시간/미디어** | openvidu-browser 2.30.0, WebSocket/STOMP | @stomp/stompjs 7.1.1, sockjs-client 1.6.1 |
| **언어** | TypeScript ~5.8.3 | tsconfig.json, tsconfig.app.json 설정 |
| **스타일링** | Tailwind CSS 3.4.1, Framer Motion | 유틸리티 우선 CSS, 애니메이션 |
| **아이콘/UX** | lucide-react 0.534.0, swiper 11.2.10, react-intersection-observer 9.16.0, react-icons 5.5.0 |  |
| **그림/화이트보드** | @tldraw/tldraw 3.15.1, @excalidraw/excalidraw 0.18.0 |  |
| **에디터** | VSCode | ESLint/Prettier 플러그인 사용 |



## **2. 빌드 시 사용되는 환경 변수 등의 상세 내용**

### **공통 / 인프라 (Common / Infra)**

| 환경변수 | 설명 | 예시 값 |
| --- | --- | --- |
| NGINX_PORT | Nginx HTTP 포트 | 80 |
| NGINX_SSL_PORT | Nginx HTTPS 포트 | 443 |
| NGINX_SSL_CERT_PATH | SSL 인증서 경로 | /etc/nginx/certs/fullchain.pem |
| NGINX_SSL_KEY_PATH | SSL 개인키 경로 | /etc/nginx/certs/privkey.pem |
| LOG_LEVEL | 애플리케이션 로그 레벨 | notice |
| Timezone | 컨테이너 타임존 설정 | Etc/UTC |
| ENV | Nginx 설정 프로파일 선택(Dockerfile ARG) | test  / prod |


### **백엔드 (Backend)**

| 환경변수 | 설명 | 예시 값 |
| --- | --- | --- |
| SPRING_DATASOURCE_URL | MySQL JDBC URL | jdbc:mysql://i13e206.p.ssafy.io:3306/e206_db?serverTimezone=Asia/Seoul&characterEncoding=UTF-8 |
| SPRING_DATASOURCE_DRIVER_CLASS_NAME | JDBC 드라이버 클래스명 | com.mysql.cj.jdbc.Driver |
| SPRING_DATASOURCE_USERNAME | DB 계정 | E206 |
| SPRING_DATASOURCE_PASSWORD | DB 비밀번호 | qwer1234 |
| SPRING_JPA_HIBERNATE_DDL_AUTO | JPA 스키마 전략 | update |
| MAIL_HOST | SMTP 서버 주소 | smtp.naver.com |
| MAIL_PORT | SMTP 서버 포트 | 465 |
| MAIL_USERNAME | SMTP 계정 | heesan6615@naver.com |
| MAIL_PASSWORD | SMTP 앱 비밀번호 | 62H81FELXBYB |
| KAFKA_BOOTSTRAP_SERVERS | Kafka 브로커 주소 | localhost:9092 (로컬), kafka:9092 (서버) |
| SPRING_KAFKA_PRODUCER_KEY_SERIALIZER | Kafka 프로듀서 키 직렬화 클래스 | org.apache.kafka.common.serialization.StringSerializer |
| SPRING_KAFKA_PRODUCER_VALUE_SERIALIZER | Kafka 프로듀서 값 직렬화 클래스 | org.apache.kafka.common.serialization.StringSerializer |
| SPRING_KAFKA_CONSUMER_GROUP_ID | Kafka 컨슈머 그룹 ID | interview-group |
| SPRING_KAFKA_CONSUMER_AUTO_OFFSET_RESET | Kafka 컨슈머 오프셋 초기화 정책 | earliest |
| SPRING_KAFKA_CONSUMER_KEY_DESERIALIZER | Kafka 컨슈머 키 역직렬화 클래스 | org.apache.kafka.common.serialization.StringDeserializer |
| SPRING_KAFKA_CONSUMER_VALUE_DESERIALIZER | Kafka 컨슈머 값 역직렬화 클래스 | org.apache.kafka.common.serialization.StringDeserializer |
| REDIS_HOST | Redis 호스트 | localhost:6379 (로컬), i13e206.p.ssafy.io (서버) |
| REDIS_CLIENT_TYPE | Redis 클라이언트 타입 | jedis (로컬) |
| REDIS_PORT | Redis 포트 | 6379 |
| JWT_SECRET | JWT 서명키(HS256) | dd8b21bc0af6193e258546d88e8506e3fb4e624ff11e570120f2e56d5bec25b5 |
| SECURITY_OAUTH2_CLINET_REGISTERATION_GOOGLE_CLIENT_ID | Google OAuth 2.0 클라이언트 ID | 420816896172-eq73a62s09upc392j6gog3pp0vbse3af.apps.googleusercontent.com |
| SECURITY_OAUTH2_CLINET_REGISTERATION_GOOGLE_CLIENT_SECRET | Google OAuth 2.0 클라이언트 시크릿 | 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 |
| SECURITY_OAUTH2_CLINET_REGISTERATION_GOOGLE_SCOPE | Google OAuth 2.0 인증 범위 | profile, email |
| SECURITY_OAUTH2_CLINET_REGISTERATION_REDIRECT_URI | Google OAuth 인증 후 리다이렉트될 URI | https://i13e206.p.ssafy.io:8445/login/oauth2/code/google |
| AWS_ACCESS_KEY | AWS 인증 Access Key | AKIA2UMF2NYK4CN3TAE4 |
| AWS_SECRET_ACCESS_KEY | AWS 인증 Secret Key | 4W7sae8dyWG+qWitQAKIskoIsXXljSEVSb4SHsGz |
| OPENVIDU_URL | OpenVidu 서버 접속 URL | https://i13e206.p.ssafy.io:8442/ |
| OPENVIDU_SECRET | OpenVidu 서버 비밀키 | i13e206 |
| OPENVIDU_RECORDING_BASE-DIR | OpenVidu 녹화 파일 저장 경로 | /home/ubuntu/openvidu_recordings |
| OPENAI_API_KEY | OpenAI API 인증 키 | S13P12E206-44b18244-970e-4239-8254-4f31ee1ddd0e |
| OPENAI_API_BASE-URL | OpenAI API 엔드포인트 주소 | https://gms.ssafy.io/gmsapi/api.openai.com/v1/ |
| SPRING_AI_OPENAI_CHAT_OPTIONS_MODEL | 채팅 모델명 | gpt-4o |
| SPRING_AI_OPENAI_EMBEDDING_OPTIONS_MODEL | 임베딩 모델명 | text-embedding-3-small |
| FASTAPI_URL | 내부 AI 모듈(FastAPI) 접속 URL | http://localhost:8000 (로컬), http://review-AI-test:8000 (서버) |


### **프론트엔드 (Frontend)**

| 환경변수 | 설명 | 예시 값 |
| --- | --- | --- |
| VITE_API_MOCKING | 프론트의 API 모킹 레이어(MSW) 사용 여부 | disabled |
| VITE_API_BASE_URL | 프론트엔드에서 호출하는 백엔드 API의 기본 URL (빌드 시 Vite에서 치환됨) | https://i13e206.p.ssafy.io:8445 |



## **3. 배포 시 특이사항**

| 구분 | 내용 |
| --- | --- |
| Reverse Proxy | NGINX에서 TLS 종단, WebSocket 업그레이드 헤더 적용 (HTTP/2/3 모듈 포함) |
| DB 마이그레이션 | 개발: ddl-auto=update, 운영: Flyway/Liquibase 사용 |
| Kafka | 브로커 DNS 사용, localhost 제거. 리스너: 내부 kafka:9092, 외부 [i13e206.p.ssafy.io:9092](http://i13e206.p.ssafy.io:9092/)  |
| Redis Vector Store | spring.data.redis와 spring.ai.vector-store.redis.uri의 호스트/포트를 통일 |
| 메일 전송 | 465(SSL) 포트 사용 |
| 시크릿 관리 | 운영은 환경변수 또는 Secret Manager 사용, VITE_ 접두사로 비밀값 노출 금지 |
| OpenVidu | NAT/방화벽 포트 개방, TURN/STUN 설정. 서버 URL/토큰 발급은 백엔드에서 대행 |
| FastAPI 연동 | 내부 서비스 DNS로 호출, 타임아웃·리트라이·인증 토큰 적용 |
| 컨테이너 베이스 이미지 | FE=Node:22-alpine, BE=Openjdk:17-jdk-slim |
| 컨테이너 네트워크 | 테스트용 FE, BE 컨테이너 : test-net 사용
배포용 FE,BE 컨테이너 : prod-net 사용 |
| 볼륨/바인드 | MySQL: /var/lib/mysql → mysql-data,
FE(Nginx): /etc/letsencrypt/... → /etc/nginx/certs/*.pem(SSL 인증서 바인드), 
BE: 마운트 없음 |
| 환경변수 전달 | FE는 빌드타임 치환(Vite, VITE_*) 사용(런타임 env 최소). BE는 표기한 Spring env 사용 |
| 빌드 전략 | 프론트 다단계 빌드(Node 22 + pnpm → Nginx 1.25-alpine), 백엔드 JAR 런타임 |
| NGINX SSL 경로 | ssl_certificate=/etc/nginx/certs/fullchain.pem, ssl_certificate_key=/etc/nginx/certs/privkey.pem |
| NGINX 로그 레벨 | error_log /var/log/nginx/error.log notice  |



## **4. DB 접속 정보 등 프로젝트(ERD)에 활용되는 주요 계정 및 프로퍼티가 정의된 파일 목록**

| 파일명 | 위치 | 내용 |
| --- | --- | --- |
| application.yml | /src/main/resources/ | MySQL, Redis, Kafka, AWS S3, OAuth2, AI, JWT, OpenVidu 주요 프로퍼티 정의 (로컬) |
| application-docker.yml | /src/main/resources/ | DB(MySQL), Redis, Kafka, AWS, OAuth2, AI 서비스, JWT, OpenVidu 주요 프로퍼티 정의 (서버) |
| gradle.properties | 루트 | Gradle 빌드 옵션 및 일부 버전 정보 |